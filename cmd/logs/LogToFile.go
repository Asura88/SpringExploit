package logs

import (
	log "github.com/sirupsen/logrus"
	"io"
	"os"
	"strings"
	"time"
)

func SaveLogs(logfile string) {
	if strings.EqualFold(logfile, "logs.txt") {

		f, err := os.OpenFile(logfile, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)
		if err == nil {
			mw := io.MultiWriter(os.Stdout, f)
			log.SetOutput(mw)
			log.SetFormatter(&log.TextFormatter{
				ForceColors:   true,
				FullTimestamp: true,
				//TimestampFormat: "2006-01-02 15:04:05",
			})
			log.SetReportCaller(true)

		} else {
			log.Info("Failed to log to file, using default stderr")
		}

	} else {
		logfile := "logs/log" + time.RFC3339 + ".txt"
		f, err := os.OpenFile(logfile, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)
		if err == nil {
			mw := io.MultiWriter(os.Stdout, f)

			log.SetOutput(mw)
			format := log.TextFormatter{
				ForceColors:   true,
				FullTimestamp: true,
				//TimestampFormat: "2006-01-02 15:04:05",
			}

			log.SetFormatter(&format)
			log.SetReportCaller(true)

		} else {
			log.Info("Failed to log to file, using default stderr")
		}

	}

}
