package attack

import (
	"github.com/SummerSec/SpringExploit/cmd/commons/poc"
	log "github.com/sirupsen/logrus"
)

func Sevice(url string, hashmap map[string]interface{}) {
	log.Debugln("github.com/SummerSec/SpringExploit/cmd/commons/attack/attack.go")
	log.Debugf("[*] Start attack %s", url)
	pocs := make(map[string]interface{})
	a := addPoc(pocs)
	//for k, v := range hashmap {
	//	log.Debugln("key: ", k, " value: ", v)
	//}
	for _, v := range a { // 循环添加poc
		t := v.(poc.PoC)
		t.SendPoc(url, hashmap)
	}

}

func init() {
	log.Debug("[*] Init attack")
}

func addPoc(pocs map[string]interface{}) map[string]interface{} {
	log.Debugln("github.com/SummerSec/SpringExploit/cmd/commons/attack/attack.go:25")
	log.Debug("[*] Add PoC")
	// TODO 添加poc
	pocs["demo"] = &poc.Demo{}
	pocs["CVE202222947"] = &poc.CVE202222947{}
	return pocs

}
