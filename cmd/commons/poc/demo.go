package poc

import (
	"github.com/SummerSec/SpringExploit/cmd/commons/utils"
	"github.com/fatih/structs"
	log "github.com/sirupsen/logrus"
)

type Demo struct{}

func (d Demo) SendPoc(url string, hashmap map[string]interface{}) {

	log.Debugf("[+] Running default poc")
	reqinfo := NewReqInfo()
	reqmap := structs.Map(reqinfo)
	reqmap["url"] = url
	//for k, v := range hashmap {
	//	log.Debugln("key: ", k, " value: ", v)
	//}

	reqmap["method"] = "GET"
	// 默认随机UA 不需要设置
	reqmap["headers"] = map[string]string{
		"User-Agent": utils.GetUA(),
	}
	reqmap["body"] = ""
	reqmap["timeout"] = hashmap["Timeout"].(int)
	reqmap["retry"] = hashmap["Retry"].(int)
	reqmap["proxy"] = hashmap["Proxy"].(string)
	reqmap["mode"] = hashmap["Mode"].(int)

	utils.Send(reqmap)

}

func (d Demo) init() {
	log.Info("[+] Registering Demo poc")

}
